function A(){const d=document.getElementById("searchToggle"),y=document.getElementById("searchClose"),x=document.getElementById("headerNormal"),o=document.getElementById("headerSearch"),m=document.getElementById("searchInput"),s=document.getElementById("searchNavigation"),c=document.getElementById("searchCount"),E=document.getElementById("searchPrev"),L=document.getElementById("searchNext");let e=[],t=0;d?.addEventListener("click",()=>{x?.classList.add("hidden"),o?.classList.remove("hidden"),o?.classList.add("flex"),m?.focus()}),y?.addEventListener("click",r);function r(){o?.classList.add("hidden"),o?.classList.remove("flex"),x?.classList.remove("hidden"),v(),m&&(m.value=""),s?.classList.add("hidden"),s?.classList.remove("flex")}function v(){document.querySelectorAll(".search-highlight").forEach(n=>{const l=n.parentNode;l&&(l.replaceChild(document.createTextNode(n.textContent||""),n),l.normalize())}),e=[],t=0}function B(n){if(v(),!n||n.length<2){s?.classList.add("hidden"),s?.classList.remove("flex");return}const l=document.querySelector(".bible-content");if(!l)return;const k=document.createTreeWalker(l,NodeFilter.SHOW_TEXT,{acceptNode:g=>{const i=g.parentElement;if(!i)return NodeFilter.FILTER_REJECT;const u=i.tagName.toLowerCase();return["script","style","noscript"].includes(u)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}}),b=[];let z;for(;z=k.nextNode();)b.push(z);b.forEach(g=>{const i=g.textContent||"",u=P(i,n);if(u.length>0){const h=document.createDocumentFragment();let p=0;u.forEach(f=>{f.start>p&&h.appendChild(document.createTextNode(i.slice(p,f.start)));const a=document.createElement("mark");a.className="search-highlight bg-yellow-300 dark:bg-yellow-600 rounded px-0.5",a.textContent=i.slice(f.start,f.end),h.appendChild(a),p=f.end}),p<i.length&&h.appendChild(document.createTextNode(i.slice(p))),g.parentNode?.replaceChild(h,g)}}),e=Array.from(document.querySelectorAll(".search-highlight")),e.length>0?(s?.classList.remove("hidden"),s?.classList.add("flex"),t=0,T(),C(0)):(s?.classList.add("hidden"),s?.classList.remove("flex"))}function S(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[,;:.!?¡¿'"«»""'']/g,"").toLowerCase()}function P(n,l){const k=S(n),b=S(l),z=[];if(!b)return z;let g=0;for(;;){const i=k.indexOf(b,g);if(i===-1)break;let u=0,h=0;for(let a=0;a<n.length&&h<i;a++){const I=n[a];S(I).length>0&&h++,u=a+1}let p=u,f=0;for(let a=u;a<n.length&&f<b.length;a++){const I=n[a];S(I).length>0&&f++,p=a+1}z.push({start:u,end:p}),g=i+1}return z}function T(){c&&(c.textContent=`${t+1}/${e.length}`),e.forEach((n,l)=>{l===t?n.classList.add("ring-2","ring-amber-500"):n.classList.remove("ring-2","ring-amber-500")})}function C(n){e[n]&&(e[n].scrollIntoView({behavior:"smooth",block:"center"}),T())}let N;m?.addEventListener("input",n=>{clearTimeout(N),N=setTimeout(()=>{B(n.target.value)},300)}),E?.addEventListener("click",()=>{e.length>0&&(t=(t-1+e.length)%e.length,C(t))}),L?.addEventListener("click",()=>{e.length>0&&(t=(t+1)%e.length,C(t))}),document.addEventListener("keydown",n=>{n.key==="Escape"&&!o?.classList.contains("hidden")&&r(),n.key==="Enter"&&document.activeElement===m&&(n.preventDefault(),e.length>0&&(t=(t+1)%e.length,C(t)))})}document.addEventListener("DOMContentLoaded",A);document.addEventListener("astro:page-load",A);let w=!1;function F(){if(w&&document.getElementById("fontSizePanel")){const e=document.querySelector(".bible-content"),t=localStorage.getItem("bibleFontSize")||"medium",r={small:"text-sm",medium:"text-base",large:"text-lg",xlarge:"text-xl"};e&&(Object.values(r).forEach(v=>e.classList.remove(v)),e.classList.add(r[t]||r.medium));return}w=!0;const d=document.getElementById("fontSizeToggle"),y=document.querySelector(".bible-content"),x={small:"text-sm",medium:"text-base",large:"text-lg",xlarge:"text-xl"};let o=document.getElementById("fontSizePanel");o||(o=document.createElement("div"),o.id="fontSizePanel",o.setAttribute("style","position: fixed; background: white; border-radius: 8px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); border: 1px solid #d1d5db; padding: 12px; min-width: 160px; z-index: 9999; display: none;"),o.innerHTML=`
				<p style="font-size: 12px; color: #6b7280; margin-bottom: 8px; font-weight: 500;">Tamaño de texto</p>
				<div style="display: flex; flex-direction: column; gap: 4px;">
					<button class="font-size-option" data-size="small" style="text-align: left; padding: 6px 12px; border-radius: 4px; border: none; background: transparent; cursor: pointer; color: #374151; font-size: 14px;">
						<span style="font-size: 12px; font-weight: bold; margin-right: 8px;">A</span> Pequeño
					</button>
					<button class="font-size-option" data-size="medium" style="text-align: left; padding: 6px 12px; border-radius: 4px; border: none; background: transparent; cursor: pointer; color: #374151;">
						<span style="font-size: 16px; font-weight: bold; margin-right: 8px;">A</span> Mediano
					</button>
					<button class="font-size-option" data-size="large" style="text-align: left; padding: 6px 12px; border-radius: 4px; border: none; background: transparent; cursor: pointer; color: #374151;">
						<span style="font-size: 18px; font-weight: bold; margin-right: 8px;">A</span> Grande
					</button>
					<button class="font-size-option" data-size="xlarge" style="text-align: left; padding: 6px 12px; border-radius: 4px; border: none; background: transparent; cursor: pointer; color: #374151;">
						<span style="font-size: 20px; font-weight: bold; margin-right: 8px;">A</span> Muy grande
					</button>
				</div>
			`,document.body.appendChild(o));const m=o.querySelectorAll(".font-size-option"),s=localStorage.getItem("bibleFontSize")||"medium";E(s),L(s);let c=!1;d&&!d.hasAttribute("data-initialized")&&(d.setAttribute("data-initialized","true"),d.addEventListener("click",e=>{if(e.stopPropagation(),e.preventDefault(),c=!c,c){const t=d.getBoundingClientRect();o.style.top=`${t.bottom+8}px`,o.style.left=`${t.left}px`,o.style.display="block"}else o.style.display="none"}),document.addEventListener("click",e=>{const t=e.target;c&&o&&!o.contains(t)&&t!==d&&!d.contains(t)&&(o.style.display="none",c=!1)})),m.forEach(e=>{e.hasAttribute("data-initialized")||(e.setAttribute("data-initialized","true"),e.addEventListener("click",t=>{t.stopPropagation();const r=e.dataset.size||"medium";E(r),L(r),localStorage.setItem("bibleFontSize",r),o.style.display="none",c=!1}))});function E(e){y&&(Object.values(x).forEach(t=>y.classList.remove(t)),y.classList.add(x[e]||x.medium))}function L(e){m.forEach(t=>{t.dataset.size===e?t.style.background="#fde68a":t.style.background="transparent"})}}document.addEventListener("DOMContentLoaded",F);document.addEventListener("astro:page-load",F);
