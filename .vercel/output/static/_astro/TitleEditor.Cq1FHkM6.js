import{j as e}from"./jsx-runtime.qnxbK-qf.js";import{r as c}from"./index.CQPPKyn2.js";function W(){const[N,C]=c.useState([]),[b,$]=c.useState(""),[g,p]=c.useState(""),[i,u]=c.useState([]),[w,f]=c.useState(!1),[j,v]=c.useState(!1),[m,o]=c.useState(null);c.useEffect(()=>{T()},[]);const T=async()=>{try{const s=await(await fetch("/api/bible-files")).json();C(s.files||[])}catch(t){console.error("Error loading files:",t)}},S=async t=>{f(!0),o(null);try{const a=await(await fetch(`/api/bible-content?file=${encodeURIComponent(t)}`)).json();a.content&&(p(a.content),k(a.content))}catch{o({type:"error",text:"Error al cargar el archivo"})}finally{f(!1)}},h=t=>{let s=t;return s=s.replace(/=(\d+)/g,"=<strong>$1</strong>"),s=s.replace(/^(\d+)(\s+\d)/g,"<strong>$1</strong>$2"),s=s.replace(/;\s+(\d+)(\s+\d)/g,"; <strong>$1</strong>$2"),s=s.replace(/([A-Za-z]{1,3})\s+(\d+)(?=\s|;|,|\.|$)/g,(a,r,l,d)=>s.substring(0,d).endsWith("<strong>")?a:`${r} <strong>${l}</strong>`),s=s.replace(/↗([A-Za-z]+)\s+(\d+)/g,(a,r,l)=>a.includes("<strong>")?a:`↗${r} <strong>${l}</strong>`),s=s.replace(/\|\|\s+(\d+)\s+([A-Za-z]+)\s+(\d+)/g,"|| $1 $2 <strong>$3</strong>"),s=s.replace(/<strong><strong>/g,"<strong>"),s=s.replace(/<\/strong><\/strong>/g,"</strong>"),s},P=t=>[/^=\d+/,/^\d+\s+\d+/,/^↗[A-Za-z]+\s+\d+/,/^\|\|/,/^[A-Za-z]{1,3}\s+\d+/,/;\s*=?\d+/,/↗[A-Za-z]+\s+\d+/].some(a=>a.test(t)),k=t=>{const s=t.split(`
`),a=[];s.forEach((r,l)=>{const d=r.match(/^## (.+)$/);if(d){const n=d[1];if(n.includes('class="section-intro"')||n.includes('class="subsection-title"')||n.includes('class="parallel-ref"')||n.startsWith("<div")||n.startsWith("<span"))return;const y=/^[IVX]+\.?\s/.test(n),z=/^\d+\.\s+[A-ZÁÉÍÓÚÑ]/.test(n),M=P(n);if(y)a.push({line:l,original:r,type:"section-intro",converted:`<span class="section-intro">${n}</span>`});else if(M){const F=h(n);a.push({line:l,original:r,type:"parallel",converted:`<span class="parallel-ref">${F}</span>`})}else z?a.push({line:l,original:r,type:"subsection-title",converted:`## <span class="subsection-title">${n}</span>`}):a.push({line:l,original:r,type:"subsection-title",converted:`## <span class="subsection-title">${n}</span>`})}}),u(a)},x=(t,s)=>{const a=i[t],r=g.split(`
`);r[a.line]=s;const l=r.join(`
`);p(l),u(d=>d.filter((n,y)=>y!==t))},I=t=>{const a=i[t].original.replace(/^## /,"");x(t,`<span class="section-intro">${a}</span>`),o({type:"success",text:"Convertido a section-intro"})},E=t=>{const a=i[t].original.replace(/^## /,"");x(t,`<span class="section-title">${a}</span>`),o({type:"success",text:"Convertido a section-title"})},A=t=>{const s=i[t],a=s.original.replace(/^## /,""),l=s.original.startsWith("## ")?"## ":"";x(t,`${l}<span class="subsection-title">${a}</span>`),o({type:"success",text:"Convertido a subsection-title"})},R=t=>{const a=i[t].original.replace(/^## /,""),r=h(a);x(t,`<span class="parallel-ref">${r}</span>`),o({type:"success",text:"Convertido a parallel-ref"})},L=async()=>{if(b){v(!0),o(null);try{const s=await(await fetch("/api/bible-content",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file:b,content:g})})).json();s.success?o({type:"success",text:"Archivo guardado correctamente"}):o({type:"error",text:s.error||"Error al guardar"})}catch{o({type:"error",text:"Error al guardar el archivo"})}finally{v(!1)}}},O=()=>{navigator.clipboard.writeText(g),o({type:"success",text:"Contenido copiado al portapapeles"})},Z=t=>{const s=t.replace(/^## /,"");return h(s)};return e.jsx("div",{className:"min-h-screen bg-gray-100 dark:bg-gray-900 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6",children:"Editor de Títulos - Sagrada Biblia"}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Seleccionar archivo:"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-200",value:b,onChange:t=>{$(t.target.value),t.target.value?S(t.target.value):(p(""),u([]))},children:[e.jsx("option",{value:"",children:"-- Seleccionar archivo --"}),N.map(t=>e.jsx("option",{value:t,children:t.replace("src/content/sagrada-biblia/","")},t))]})]}),m&&e.jsx("div",{className:`p-3 rounded-lg mb-4 ${m.type==="success"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:m.text}),w&&e.jsx("div",{className:"text-center py-8 text-gray-600 dark:text-gray-400",children:"Cargando..."}),i.length>0&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-4",children:["Títulos encontrados (",i.length,")"]}),e.jsx("div",{className:"space-y-3 max-h-[500px] overflow-y-auto",children:i.map((t,s)=>e.jsxs("div",{className:"flex flex-col gap-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Línea ",t.line+1]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${t.type==="section-intro"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":t.type==="parallel"?"bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200":"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200"}`,children:t.type==="section-intro"?"Sección":t.type==="parallel"?"Paralelo":"Subtítulo"})]}),e.jsx("code",{className:"text-sm text-gray-800 dark:text-gray-200 block bg-gray-200 dark:bg-gray-600 p-2 rounded",children:t.original}),t.type==="parallel"&&e.jsxs("div",{className:"mt-2 text-xs text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-medium",children:"Vista previa: "}),e.jsx("span",{className:"font-serif",dangerouslySetInnerHTML:{__html:Z(t.original)}})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>I(s),className:"px-3 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition",title:"Convertir a sección intro (para títulos principales con números romanos)",children:"→ section-intro"}),e.jsx("button",{onClick:()=>E(s),className:"px-3 py-2 bg-teal-600 text-white text-sm rounded hover:bg-teal-700 transition",title:"Convertir a título de sección (tamaño intermedio, centrado, negro)",children:"→ section-title"}),e.jsx("button",{onClick:()=>A(s),className:"px-3 py-2 bg-purple-600 text-white text-sm rounded hover:bg-purple-700 transition",title:"Convertir a subtítulo de subsección",children:"→ subsection-title"}),e.jsx("button",{onClick:()=>R(s),className:"px-3 py-2 bg-amber-600 text-white text-sm rounded hover:bg-amber-700 transition",title:"Convertir a referencia paralela (capítulos en negrita)",children:"→ parallel-ref"})]})]},`${t.line}-${s}`))})]}),g&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100",children:"Contenido del archivo"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:O,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition",children:"Copiar"}),e.jsx("button",{onClick:L,disabled:j,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition disabled:opacity-50",children:j?"Guardando...":"Guardar"})]})]}),e.jsx("textarea",{className:"w-full h-96 p-4 font-mono text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-900 text-gray-800 dark:text-gray-200",value:g,onChange:t=>{p(t.target.value),k(t.target.value)}})]}),e.jsxs("div",{className:"mt-6 bg-amber-50 dark:bg-amber-900/30 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-amber-800 dark:text-amber-200 mb-3",children:"Guía de conversión:"}),e.jsxs("ul",{className:"text-sm text-amber-700 dark:text-amber-300 space-y-3",children:[e.jsxs("li",{children:[e.jsx("strong",{className:"text-blue-700 dark:text-blue-300",children:"section-intro:"}),' Para títulos de sección principal (ej: "II. Historia de Abrahán")',e.jsx("br",{}),e.jsx("code",{className:"bg-amber-100 dark:bg-amber-800 px-1 rounded text-xs",children:'<span class="section-intro">II. Historia de Abrahán</span>'})]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-teal-700 dark:text-teal-300",children:"section-title:"}),' Título intermedio, centrado y negro (ej: "LIBRO PRIMERO", "PRIMERA PARTE")',e.jsx("br",{}),e.jsx("code",{className:"bg-amber-100 dark:bg-amber-800 px-1 rounded text-xs",children:'<span class="section-title">LIBRO PRIMERO</span>'})]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-purple-700 dark:text-purple-300",children:"subsection-title:"}),' Para subtítulos (ej: "2. EL DILUVIO", "Vocación de Abrahán")',e.jsx("br",{}),e.jsx("code",{className:"bg-amber-100 dark:bg-amber-800 px-1 rounded text-xs",children:'## <span class="subsection-title">2. EL DILUVIO</span>'})]}),e.jsxs("li",{children:[e.jsx("strong",{className:"text-amber-700 dark:text-amber-300",children:"parallel-ref:"}),' Para referencias paralelas (ej: "2 4-25 ↗Jn 1 1-3")',e.jsx("br",{}),e.jsx("code",{className:"bg-amber-100 dark:bg-amber-800 px-1 rounded text-xs",children:'<span class="parallel-ref"><strong>2</strong> 4-25 ↗Jn <strong>1</strong> 1-3</span>'}),e.jsx("br",{}),e.jsx("span",{className:"text-xs italic",children:"Los números de capítulo se ponen en negrita automáticamente"})]})]})]})]})})}export{W as default};
